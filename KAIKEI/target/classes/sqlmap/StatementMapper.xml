<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ts.kaikei.dao.StatementDAO">

    <select id="getStatementList" parameterType="String" resultType="StatementListVO">
    
    	SELECT STT.account_cd, ACC.title, STT.customer_cd, STT.date, 
    			STT.classify, STT.debtor, STT.creditor, STT.abs
    	FROM statements AS STT, account AS ACC
    	WHERE 1=1
    	AND STT.company_cd = #{company_cd}
    	AND STT.account_cd = ACC.acc_cd

    </select>
    
    <insert id="addStatement" parameterType="StatementVO" >
    
        INSERT INTO statements
        VALUES(
        #{company_cd}, nextval('seq_company_${company_cd}'), #{account_cd}, 
        #{customer_cd}, to_date(#{date},'YYYY-MM-DD'), #{classify}, 
        #{debtor}, #{creditor}, #{abs}, 
        #{ent_id}, NOW(), #{ent_prog},
        #{mod_id}, NOW(), #{mod_prog})
        
    </insert>

</mapper>