<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ts.kaikei.dao.StatementDAO">

    <select id="getStatementList" parameterType="String" resultType="StatementListVO">
    
    	SELECT TO_CHAR(STT.date, 'YY') AS year, TO_CHAR(STT.date, 'MM') AS month, TO_CHAR(STT.date, 'DD') AS date,
    			STT.account_cd, ACC.title, STT.customer_cd, 
    			STT.classify, STT.debtor, STT.creditor, STT.abs
    	FROM statements AS STT, account AS ACC
    	WHERE 1=1
    	AND STT.company_cd = #{company_cd}
    	AND STT.account_cd = ACC.acc_cd
    	ORDER BY date ASC;

    </select>
    
    <insert id="addStatement" parameterType="StatementVO" >
    
        INSERT INTO statements
        VALUES(
        #{company_cd}, nextval('seq_company_${company_cd}'), #{account_cd}, 
        #{customer_cd}, #{date}::date, #{classify}, 
        #{debtor}, #{creditor}, #{abs}, 
        #{ent_id}, NOW(), 'Web-kaikei', 
        #{mod_id}, NOW(), 'Web-kaikei')
        
    </insert>

</mapper>